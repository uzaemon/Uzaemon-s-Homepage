<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<HEAD>
<META http-equiv="Content-Style-Type" content="text/css">
<title>Message 00252 : Re^2: SNDM (error using 30 *CCs)</title>
</head>
<BODY bgcolor="#99CCFF">
<b><font size = +1>00252 [Re^2: SNDM (error using 30 *CCs)] </font>(posted by MY_KATOH)</b><br>
( 1)   01/10/02 09:41   comment on <a href="00251.html">00251</a>   , # of comment(s) : 2
<HR>

> MY_KATOHさん、こんにちは。<br>
><br>
> > ...CLプログラムにてCCでの送り先用に３０個のフィールドを用意してこのコマンドを使うと、結果的にCCが必要なく、SNDMのCCパラメーターに*CHARのブランクが入ってしまいコマンドがエラーになってしまいます。<br>
><br>
> 状況が良く把握できないのですが、下記について情報をいただけますでしょうか。<br>
><br>
> - 「結果的にCCが必要なく」とはどのような意味でしょうか<br>
> - 具体的なエラーの内容(エラーコード、メッセージIDなど)<br>
> - DEBUG(*YES)を指定して出力されるスプールファイルのパラメーター部分の内容<br>
><br>
> よろしくお願いします。<br>
><br>
> uzaemon@Japan<br>
早速ありがとうございます。詳細に説明させていただきます。<br>
SNDMを使うプログラムPROGRAM_AでTOのパラメーター用に&TO,&CC01,<br>
&CC02,.....(30個というのはあまり意味がありませんでした。すいません）と変数を用意します。<br>
SNDM FROM(&SENDER) TO((&TO) (&CC01 *N *CC))<br>
とコーディングします。<br>
この用意した変数に全て存在するアドレスが入る場合はメールが送信されます。<br>
存在しないアドレスが入るとCPA0702でfailed. reason -301 negative response from SMTP server ( RSP[550 5.1.1 User unknown｣･] REQ[RCPT TO:<>｣･])で落ちてしまいます。<br>
これと同じく、&CC01にユーザーが任意で入れさせるようなプログラムからPROGRAM_Aを呼ぶ場合、ユーザーが入力せず（必要ないと判断した場合）、結果的に&CC01に*CHARのブランク(X'404040...')が入ってしまい、User Unknownという（考えてみればあたりまえなのですが）事になってしまいます。これを、コーディングで回避する以外になにか良い手が無いかというご質問です。<br>
わがままな質問ですが、よろしくお願いいたします。<br>
</body></html>
